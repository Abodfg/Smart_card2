# دليل الإشعارات الإدارية - Abod Card

## 👥 الإداريين المفوضين

### 🔧 الإدارة الرئيسية
**Telegram ID:** `7040570081`
**الصلاحيات:** وصول كامل لجميع وظائف Admin Bot
**الإشعارات:** جميع إشعارات النشاط التجاري والطلبات

### ⚙️ إدارة النظام  
**Telegram ID:** `1573526135`
**الصلاحيات:** وصول كامل لجميع وظائف Admin Bot
**الإشعارات:** نبض النظام وإشعارات الطوارئ فقط

---

## 📨 تقسيم الإشعارات

### 🔧 الإدارة الرئيسية تتلقى:

#### 📦 إشعارات الطلبات:
- **الطلبات الجديدة** (مكتملة أو معلقة)
- **الطلبات اليدوية** (تحتاج تنفيذ يدوي)
- **نفاد الأكواد** (تحذير نقص المخزون)
- **الطلبات المتأخرة** (أكثر من 30 دقيقة)

#### 👥 إشعارات المستخدمين:
- **إضافة رصيد للمستخدمين**
- **العمليات المالية**
- **طلبات الدعم الفني**

#### 💰 إشعارات المالية:
- **المبيعات اليومية**
- **تحديثات الأرصدة**
- **إجمالي الإيرادات**

---

### ⚙️ إدارة النظام تتلقى:

#### 💗 نبض النظام (كل 10 دقائق):
```
💗 نبضة النظام - 15:30

✅ النظام يعمل بشكل طبيعي

📊 الإحصائيات:
👥 المستخدمين: 250
📦 طلبات اليوم: 45
⏳ طلبات معلقة: 2
🎫 أكواد متاحة: 1,234

🕐 آخر فحص: 2025-09-26 15:30:00 UTC
```

#### 🚨 إشعارات الطوارئ:
- **تعطل المهام الخلفية**
- **أخطاء النظام الحرجة**
- **فشل في إرسال الإشعارات**
- **انقطاع الاتصال بقاعدة البيانات**

#### ⚠️ التحذيرات الذكية:
- **أكثر من 5 طلبات معلقة**
- **الأكواد أقل من 50**
- **استخدام ذاكرة عالي**
- **بطء في الاستجابة**

---

## 🔄 مواعيد الإشعارات

### ⏱️ الإشعارات الدورية:
- **نبض النظام:** كل 10 دقائق
- **فحص الطلبات المعلقة:** كل ساعة (6 × 10 دقائق)
- **إحصائيات يومية:** منتصف الليل

### ⚡ الإشعارات الفورية:
- **طلب جديد:** فوراً عند الإنشاء
- **نفاد الأكواد:** عند الوصول لآخر كود
- **خطأ في النظام:** فوراً عند الحدوث
- **طلب متأخر:** بعد 30 دقيقة من الإنشاء

---

## 🎛️ التحكم في الإشعارات

### لتعديل مدة نبض النظام:
**📂 الملف:** `/app/backend/server.py`
**📍 السطر:** 3360
```python
await asyncio.sleep(600)  # 10 دقائق (600 ثانية)
```

### لتعديل حد تحذير الأكواد:
**📂 الملف:** `/app/backend/server.py`
**📍 السطر:** 3310
```python
if available_codes < 50:  # تغيير الرقم 50
    warnings.append(f"⚠️ الأكواد قليلة: {available_codes} فقط")
```

### لتعديل حد تحذير الطلبات المعلقة:
**📂 الملف:** `/app/backend/server.py`
**📍 السطر:** 3308
```python
if pending_orders > 5:  # تغيير الرقم 5
    warnings.append(f"⚠️ يوجد {pending_orders} طلب معلق")
```

---

## 🔧 استكشاف الأخطاء

### إذا لم تصل إشعارات نبض النظام:
1. تحقق من عمل المهام الخلفية:
```bash
tail -f /var/log/supervisor/backend.*.log | grep "نبضة النظام"
```

2. تحقق من صحة SYSTEM_ADMIN_ID:
```bash
grep "SYSTEM_ADMIN_ID" /app/backend/server.py
```

### إذا لم تصل إشعارات الطلبات:
1. تحقق من ADMIN_ID الرئيسي:
```bash
grep "ADMIN_ID.*=" /app/backend/server.py
```

2. تحقق من أن Admin Bot يعمل:
```bash
curl -X GET "https://api.telegram.org/bot7835622090:AAGLTeEv-zUdNNkUrkS_L_FCd3zSUOosVeU/getMe"
```

---

## 📱 أرقام التواصل

### 🔧 الإدارة الرئيسية:
- **Telegram ID:** `7040570081`
- **المسؤولية:** إدارة العمليات والطلبات
- **نوع الإشعارات:** طلبات، مبيعات، دعم فني

### ⚙️ إدارة النظام:
- **Telegram ID:** `1573526135`  
- **المسؤولية:** مراقبة النظام والأداء
- **نوع الإشعارات:** نبض النظام، طوارئ، أخطاء

---

## 🔄 إعادة تشغيل النظام

```bash
# إعادة تشغيل النظام لتطبيق التغييرات
sudo supervisorctl restart backend

# التحقق من الحالة
sudo supervisorctl status

# مراقبة السجلات
tail -f /var/log/supervisor/backend.*.log
```

---

**📝 آخر تحديث:** سبتمبر 2025  
**🔧 الإصدار:** 2.0 - نظام إشعارات متعدد الإداريين